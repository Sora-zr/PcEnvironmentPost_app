<%= form_with model: post, local: true do |f| %>
  <%= render 'shared/error_messages', object: f.object %>

  <div class="form-group mb-3">
    <%= f.label :description %>
    <%= f.text_area :description, rows: 8, class: 'form-control' %>
  </div>

  <div class="form-group mb-3">
    <%= f.label :images, class: "form-label" %>
    <%= f.file_field :images, multiple: true, onchange: "postImage(this);", accept: "image/jpeg,image/gif,image/png", class: "form-control" %>
  </div>

  <div id="image">
    <img id="image_preview" class="mb-3" width="100">
  </div>

  <% if @post.images.present? %>
    <span><b>[現在登録されている画像]</b></span>
    <% @post.images.each do |image| %>
      <%= image_tag image, class: 'card-img-top', size: '600x400', style: "object-fit: cover;" %>
    <% end %>
  <% end %>

  <%= f.submit nil, class: 'btn btn-primary' %>
<% end %>

<script>
    function postImage(obj) {
        var fileReader = new FileReader();
        fileReader.onload = (function() {
            document.getElementById('image_preview').src = fileReader.result;
        });
        fileReader.readAsDataURL(obj.files[0]);
    }
</script>