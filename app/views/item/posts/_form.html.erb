<%= form_with model: post, local: true do |f| %>
  <%= render 'shared/error_messages', object: f.object %>

  <div class="form-group mb-3">
    <%= f.label :name %>
    <%= f.text_field :name, class: 'form-control' %>
  </div>

  <div class="form-group mb-3">
    <%= f.label :description %>
    <%= f.text_area :description, rows: 8, class: 'form-control' %>
  </div>

  <div class="form-group mb-3">
    <%= f.label :image, class: "form-label" %>
    <%= f.file_field :image, onchange: "imageImage(this);", accept: "image/jpeg,image/gif,image/png", class: "form-control" %>
  </div>

  <div id="image">
    <img id="image_preview" class="mb-3" width="100">
  </div>

  <% if @post.image.present? %>
    <span><b>[現在登録されている画像]</b></span>
    <%= image_tag @post.image, width: 200, class: "mb-2" %>
  <% end %>

  <div class="form-group mb-3">
    <%= f.label :tag_list %>
    <%= f.text_field :tag_list, value: post.tag_list.join(','), class: 'form-control' %>
  </div>

  <%= f.submit nil, class: 'btn btn-primary' %>
<% end %>

<script>
  function imageImage(obj) {
      var fileReader = new FileReader();
      fileReader.onload = (function() {
          document.getElementById('image_preview').src = fileReader.result;
      });
      fileReader.readAsDataURL(obj.files[0]);
  }
</script>